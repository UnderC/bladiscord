(this.webpackJsonpbladiscord=this.webpackJsonpbladiscord||[]).push([[0],{96:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),a=n(11),r=n.n(a),i=n(8),s=n(25),l=n(122),u=n(124),d=n(144),j=n(125),b=n(126),h=n(127),p=n(147),f=n(146),O=n(128),g=n(129),m=n(145),v=n(131),x=n(132),w=n(120),y=n(53),S=n.n(y),k=n(70),C=n.n(k),N=n(14),T="SET_WS",E={},I=function(e){return{type:T,raw:e}},_=function(e,t){return Object(i.a)(Object(i.a)({},e),{},{ws:t.raw})},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return _(e,t);default:return e}},B="GET_PASSWD",G=function(e){return{type:B,raw:e}},U=function(e,t){return Object(i.a)(Object(i.a)({},e),{},{passwd:t.raw})},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return U(e,t);default:return e}},A={},W="GET_USER",z=function(e){return{type:W,raw:e}},D=function(e,t){return Object(i.a)(Object(i.a)({},e),{},{user:t.raw})},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case W:return D(e,t);default:return e}},M="wss://gateway.discord.gg/?v=".concat(8,"&encoding=json"),P="".concat("https://discord.com/api","/v").concat(8),H={gateway:{dispatch:0,heartbeat:1,identify:2,presenceUpdate:3,voiceStateUpdate:4,resume:6,reconnect:7,requestGuildMembers:8,invalidSession:9,hello:10,heartbeakACK:11}},R=n(3),q=null,$={$os:"Browser",$browser:"Firefox",$device:"Blackberry Classic"},K=Object(w.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}})),Y=Boolean(window.localStorage.getItem("otoLogin")||!1),Q=Object(N.b)((function(e){return Object(i.a)(Object(i.a)({},e.passwd),e.gatewayWS)}))((function(e){var t=K(),n=e.dispatch,c=e.ws,a=o.a.useState(Y),r=Object(s.a)(a,2),i=r[0],w=r[1],y=o.a.useState(window.localStorage.getItem("token")||""),k=Object(s.a)(y,2),N=k[0],T=k[1],E=o.a.useState(!1),_=Object(s.a)(E,2),F=_[0],B=_[1],U=function(e,t){(c||t)&&(c||t).send(JSON.stringify(e))},L=function(){if(!c&&!F){B(!0),window.localStorage.setItem("token",N),i!==Y&&window.localStorage.setItem("otoLogin",i);var e=new WebSocket(M);e.onerror=function(){window.localStorage.setItem("otoLogin",!1)},e.onclose=function(){var e;(e=console).log.apply(e,arguments),n(z(null)),n(G(null)),window.localStorage.setItem("otoLogin",!1)},e.onopen=function(){},e.handlers=[],e.onmessage=function(t){var c=JSON.parse(t.data);q=c.s||q,c.op===H.gateway.hello?(setInterval((function(){U({op:H.gateway.heartbeat,d:q},e),console.log("heartbeat "+q)}),c.d.heartbeat_interval+Math.random()),U({op:H.gateway.identify,d:{token:N,properties:$,presence:{status:"dnd",afk:!1},compress:!1,large_threshold:250,intents:32519}},e)):c.op===H.gateway.dispatch?"READY"===c.t&&(n(z(c.d)),n(G(N))):(c.op,H.gateway.reconnect),e.handlers.forEach((function(e){return e(c)}))},n(I(e))}};return console.log(F,N,Y),Y&&N&&!F&&L(),F?Object(R.jsx)(l.a,{className:t.backdrop,open:F,children:Object(R.jsx)(u.a,{color:"inherit"})}):Object(R.jsxs)(d.a,{open:!0,children:[Object(R.jsx)(j.a,{children:"BlaDiscord"}),Object(R.jsx)(b.a,{children:Object(R.jsxs)(h.a,{children:[Object(R.jsx)(p.a,{htmlFor:"token",children:"\ud1a0\ud070"}),Object(R.jsx)(f.a,{value:N,"aria-describedby":"tokenHelperTxt",onChange:function(e){T(e.target.value)},id:"token"}),Object(R.jsx)(O.a,{id:"tokenHelperTxt",children:"\ud1a0\ud070 \uc815\ubcf4\ub294 \uc11c\ubc84\ub85c \uc804\uc1a1\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4"}),Object(R.jsx)(g.a,{control:Object(R.jsx)(m.a,{checked:i,onChange:function(e){w(e.target.checked)},name:"otoLogin",color:"primary"}),label:"\uc790\ub3d9 \ub85c\uadf8\uc778"})]})}),Object(R.jsxs)(v.a,{children:[Object(R.jsx)(x.a,{onClick:function(){if(!c)return window.close();c.close(),n(I(null))},children:Object(R.jsx)(S.a,{})}),Object(R.jsx)(x.a,{color:"primary",onClick:L,children:Object(R.jsx)(C.a,{})})]})]})})),V=n(130),X=n(141),Z=n(81),ee=n(23),te=n(142),ne=n(143),ce=n(75),oe=n.n(ce),ae=n(77),re=n.n(ae),ie=n(76),se=n.n(ie),le="FOCUS_GUILD",ue=function(e){return{type:le,raw:e}},de=function(e,t){return Object(i.a)(Object(i.a)({},e),{},{focused:t.raw})},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case le:return de(e,t);default:return e}},be="FOCUS_CHANNEL",he=function(e){return{type:be,raw:e}},pe=function(e,t){return Object(i.a)(Object(i.a)({},e),{},{focusedChannel:t.raw})},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case be:return pe(e,t);default:return e}},Oe=n(133),ge=n(134),me=n(135),ve=n(148),xe=n(136),we=Object(N.b)((function(e){return Object(i.a)(Object(i.a)({},e.focusGuild),e.getUser)}))((function(e){var t=e.dispatch,n=e.user;return Object(R.jsx)(Oe.a,{children:n.guilds.map((function(e,n){return Object(R.jsxs)(ge.a,{onClick:function(){return t(ue(e))},children:[Object(R.jsx)(me.a,{children:Object(R.jsx)(ve.a,{alt:e.name,src:"https://cdn.discordapp.com/icons/".concat(e.id,"/").concat(e.icon,".webp?size=128")})}),Object(R.jsx)(xe.a,{primary:e.name})]},"listG".concat(n))}))})})),ye=n(54),Se=n(32),ke=n(137),Ce=n(71),Ne=n.n(Ce),Te=n(72),Ee=n.n(Te),Ie=function(e,t){return e.members.find((function(e){return e.user.id===t}))},_e=Object(w.a)((function(e){return{subheader:{backgroundColor:e.palette.background.paper}}})),Fe=function(e){var t,n=[],c=Object(Se.a)([{dummy:!0,type:4,id:null}].concat(e.filter((function(e){return 4===e.type}))));try{var o=function(){var c=t.value;c.children=e.filter((function(e){return 4!==e.type&&e.parent_id===c.id})).sort((function(e,t){return e.position-t.position})).sort((function(e,t){return e.type-t.type})),n.push(c)};for(c.s();!(t=c.n()).done;)o()}catch(a){c.e(a)}finally{c.f()}return n},Be=function(e,t,n){var c=e.map((function(e){return e.id}));return t.filter((function(e){var t=!1,o=0;if(console.log("================================"),console.log(e.permission_overwrites),n.permission_overwrites){var a,r=n.permission_overwrites.filter((function(e){return c.includes(e.id)})),i=Object(Se.a)(r);try{for(i.s();!(a=i.n()).done;){var s=a.value;0!==(Number(s.allow)||Number(s.deny))&&(t=!0),o|=Number(s.allow),o&=~Number(s.deny)}}catch(b){i.e(b)}finally{i.f()}}var l=e.permission_overwrites.filter((function(e){return c.includes(e.id)}));console.log(l);var u,d=Object(Se.a)(l);try{for(d.s();!(u=d.n()).done;){var j=u.value;0!==(Number(j.allow)||Number(j.deny))&&(t=!0),o|=Number(j.allow),o&=~Number(j.deny)}}catch(b){d.e(b)}finally{d.f()}return console.log(o),!t||1024===(1024&o)||2048===(2048&o)}))},Ge=Object(N.b)((function(e){return Object(i.a)(Object(i.a)({},e.getUser),e.focusGuild)}))((function(e){var t=_e(),n=e.dispatch,c=e.focused,a=e.user,r=function(e,t){var n=t.roles.filter((function(t){return e.roles.includes(t.id)}));return[t.roles[0]].concat(Object(ye.a)(n)).sort((function(e,t){return e.position-t.position}))}(Ie(c,a.user.id),c);return Object(R.jsx)(Oe.a,{children:Fe((null===c||void 0===c?void 0:c.channels)||[]).map((function(e,c){return Object(R.jsxs)(o.a.Fragment,{children:[Object(R.jsx)(ke.a,{className:t.subheader,children:e.name},"listCate".concat(c)),Be(r,e.children,e).map((function(e,t){return Object(R.jsxs)(ge.a,{onClick:function(){return n(he(e))},children:[Object(R.jsx)(me.a,{children:0===e.type?Object(R.jsx)(Ne.a,{}):Object(R.jsx)(Ee.a,{})}),Object(R.jsx)(xe.a,{primary:e.name})]},"listChan".concat(t))}))]})}))})})),Ue=n(61),Le=n.n(Ue),Ae=n(138),We=n(139),ze=n(140),De=n(74),Je=n.n(De),Me=n(73),Pe=n.n(Me),He=Object(w.a)({root:{maxWidth:345,marginTop:"10px"}}),Re=function(e){var t=He(),n=e.message;return console.log(null===n||void 0===n?void 0:n.attachments),Object(R.jsxs)(o.a.Fragment,{children:[Object(R.jsx)("div",{style:{wordBreak:"break-all"},children:n.content.startsWith("http")?Object(R.jsx)("a",{href:n.content,children:n.content}):n.content}),null===n||void 0===n?void 0:n.attachments.map((function(e){var n;return"image"===(null===(n=e.content_type)||void 0===n?void 0:n.split("/")[0])||e.height&&e.width?Object(R.jsx)(Ae.a,{className:t.root,children:Object(R.jsx)(We.a,{style:{height:345*e.height/e.width},image:e.proxy_url})}):Object(R.jsx)(Ae.a,{className:t.root,children:Object(R.jsx)(ze.a,{avatar:Object(R.jsx)(Pe.a,{}),title:e.filename,subheader:e.content_type,action:Object(R.jsx)(V.a,{onClick:function(){return t=e.url,void window.open(t);var t},children:Object(R.jsx)(Je.a,{})})})})}))]})},qe=function(e){var t,n=[],c=null,o=e.map((function(e){var t=c;if(c=e.author.id,t!==e.author.id)return e.author})),a=0,r=Object(Se.a)(o);try{var i=function(){var c=t.value;if(!c)return"continue";var o=c.id,r=!1,i=e.filter((function(e,t){return!(r||a>t)&&(o===e.author.id||(a=t,r=!0,!1))}));c.messages=i,n.push(c)};for(r.s();!(t=r.n()).done;)i()}catch(s){r.e(s)}finally{r.f()}return n},$e=Object(N.b)((function(e){return Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},e.focusChannel),e.focusGuild),e.getUser),e.passwd),e.gatewayWS)}))((function(e){var t=o.a.useState([]),n=Object(s.a)(t,2),c=n[0],a=n[1],r=document.getElementById("otoScr"),i=(e.dispatch,e.focused),l=e.focusedChannel,u=(e.user,e.passwd),d=e.ws,j=!0;document.onscroll=function(){j=document.scrollingElement.scrollTop>=document.scrollingElement.scrollTopMax};var b=function(){var e;j&&(r||(r=document.getElementById("otoScr")),document.scrollingElement.scrollTo(0,null===(e=r)||void 0===e?void 0:e.scrollHeight))};return d.handlers[0]=function(e){if("MESSAGE_CREATE"===e.t){if(e.d.channel_id!==l.id)return;a([].concat(Object(ye.a)(c),[e.d])),b()}},c.length||fetch("".concat(P,"/channels/").concat(l.id,"/messages"),{method:"GET",headers:{Authorization:"".concat(u)}}).then((function(e){return e.json()})).then((function(e){a(e.reverse()),b()})),Object(R.jsxs)(o.a.Fragment,{children:[Object(R.jsx)(V.a,{children:Object(R.jsx)(Le.a,{})}),qe(c).map((function(e){var t;return Object(R.jsxs)(ge.a,{style:{alignItems:"flex-start"},children:[Object(R.jsx)(me.a,{children:Object(R.jsx)(ve.a,{src:"https://cdn.discordapp.com/avatars/".concat(e.id,"/").concat(e.avatar,".webp?size=128")})}),Object(R.jsx)(xe.a,{primary:(null===(t=Ie(i,e.id))||void 0===t?void 0:t.nick)||e.username,secondary:Object(R.jsx)(o.a.Fragment,{children:e.messages.map((function(e){return Object(R.jsx)(Re,{message:e})}))})})]})}))]})})),Ke=Object(w.a)((function(e){return{text:{padding:e.spacing(2,2,0),whiteSpace:"nowrap",textOverflow:"ellipsis"},paper:{paddingBottom:50},list:{marginBottom:e.spacing(2)},appBar:{top:"auto",bottom:0},grow:{flexGrow:1},root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]},topic:{padding:e.spacing(2,2,0),display:"inline-block",overflow:"hidden",width:"300px",whiteSpace:"nowrap",textOverflow:"ellipsis",paddingTop:"0"},topic2:{whiteSpace:"pre",paddingTop:"0"}}}));var Ye=Object(N.b)((function(e){return Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},e.focusGuild),e.focusChannel),e.getUser),e.passwd),e.gatewayWS)}))((function(e){var t=Ke(),n=o.a.useState(!1),c=Object(s.a)(n,2),a=c[0],r=c[1],i=o.a.useState(""),l=Object(s.a)(i,2),u=l[0],h=l[1],p=e.dispatch,O=e.focused,g=e.focusedChannel,m=e.ws,x=e.passwd;if(!x)return Object(R.jsx)(Q,{});return Object(R.jsxs)(o.a.Fragment,{children:[Object(R.jsxs)(d.a,{onClose:function(){return r(!1)},open:a,children:[Object(R.jsxs)(j.a,{children:["#",null===g||void 0===g?void 0:g.name]}),Object(R.jsx)(b.a,{className:t.topic2,children:null===g||void 0===g?void 0:g.topic}),Object(R.jsx)(v.a,{children:Object(R.jsx)(V.a,{onClick:function(){return r(!1)},children:Object(R.jsx)(S.a,{})})})]}),Object(R.jsx)(X.a,{}),Object(R.jsx)(Z.a,{square:!0,className:t.paper,style:{position:"fixed",zIndex:"2",width:"100%",height:"75px"},children:Object(R.jsxs)(ee.a,{className:t.text,variant:"h5",children:[Object(R.jsx)(V.a,{onClick:function(){g?p(he(null)):O?p(ue(null)):(window.localStorage.removeItem("otoLogin"),m.close(),window.location.reload())},edge:"start",color:"inherit",children:Object(R.jsx)(oe.a,{})}),Object(R.jsx)("span",{onClick:function(){return r(!0)},children:(null===g||void 0===g?void 0:g.name)||(null===O||void 0===O?void 0:O.name)||"\uc120\ud0dd\ub41c \uc11c\ubc84 \uc5c6\uc74c"})]})}),Object(R.jsxs)(Z.a,{square:!0,className:t.paper,id:"otoScr",style:{paddingTop:"70px"},children:[O?g?Object(R.jsx)($e,{}):Object(R.jsx)(Ge,{}):Object(R.jsx)(we,{}),Object(R.jsx)("form",{action:"upload",id:"uploadForm",method:"post",enctype:"multipart/form-data",children:Object(R.jsx)("input",{onChange:function(e){var t=new FormData;t.append("file",e.target.files[0]),fetch("".concat(P,"/channels/").concat(g.id,"/messages"),{method:"POST",headers:{Authorization:"".concat(x)},body:t}).then(console.log).catch(console.error)},type:"file",name:"file",id:"file",style:{display:"none"}})})]}),Object(R.jsx)(te.a,{position:"fixed",color:"primary",style:{top:"auto",bottom:"0"},children:Object(R.jsxs)(ne.a,{children:[Object(R.jsx)(V.a,{edge:"start",color:"inherit",onClick:function(){return document.all.file.click()},children:Object(R.jsx)(se.a,{})}),Object(R.jsx)(f.a,{color:"inherit",value:u,onChange:function(e){h(e.target.value)},style:{display:"inline-flex","flex-grow":"2"}}),Object(R.jsx)(V.a,{onClick:function(){g&&(fetch("".concat(P,"/channels/").concat(g.id,"/messages"),{method:"POST",headers:{Authorization:"".concat(x),"Content-Type":"application/json"},body:JSON.stringify({tts:!1,content:u})}).then(console.log).catch(console.error),h(""))},edge:"end",color:"inherit",children:Object(R.jsx)(re.a,{})})]})})]})})),Qe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,150)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),o(e),a(e),r(e)}))},Ve=n(33),Xe=(n(78),[n(79).a]),Ze=Object(Ve.combineReducers)({focusGuild:je,focusChannel:fe,getUser:J,passwd:L,gatewayWS:F}),et=function(e){return Object(Ve.createStore)(Ze,Ve.applyMiddleware.apply(void 0,Xe))}();r.a.render(Object(R.jsx)(N.a,{store:et,children:Object(R.jsx)(Ye,{})}),document.getElementById("root")),Qe()}},[[96,1,2]]]);
//# sourceMappingURL=main.c66d5d56.chunk.js.map